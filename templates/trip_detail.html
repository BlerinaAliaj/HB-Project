{% extends 'base.html' %}

{% block title %} 
<meta name="viewport" content="initial-scale=1.0">
<meta charset="utf-8">
<style type="text/css"></style>
{% endblock %}

{% block head %}
<!-- <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"> -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.0/united/bootstrap.min.css"
        rel="stylesheet">
<link href="/static/style.css" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.2/angular.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.2/angular-route.js"></script>
{% endblock %}

{% block content %}



<div class="row" style="height: 300px">
  <div class="col-xs-3" style="height: 300px">
    <a id="mylink" href="/new_trip">Create New Trip</a>
    <div class="col-xs-12" style="display:none">
      <h1>Please fill out information about your trip below:</h1>
      <form class="tripform" action="/new_trip" method="POST">
      Trip Name: <input id="tripn" type="text" name="tripname"><br>
      Start Date: <input id="sdate" type="date" name="datestart"><br>
      Number of Days: <input id="numdays" type="number" name="numdays"><br>
      <input type="submit" value="submit"><br>
      <input id="minimize" type="button" value="Minimize">
      </form>
    </div>

    <div ng-controller="ListLatestTrips" style="overflow-y: scroll; height: 300px">
      <p>Recent trips:</p>
        {% raw %}
          <li id="new_trip" ng-repeat="x in mytrips" >
            <a href="/trip_detail/{{ x.trip_code }}">
                {{ x.trip_name }}</a> 
          </li>
        {% endraw %}
    </div>
  </div>

  <div class="col-xs-4" style="display:inline-block"=>
      <h3>Hello {{ name }}:</h3>
      <h4>Welcome to {{ trip_name }} trip page. </h4>    
      <h5>People that are joining you on this trip:</h5>
      <ul>
          {% for member in members %}
              {% if member.user_id != username %}
              <li>
                <a href="/member_profile/{{ username }}">
                  {{ member.first_name }} {{ member.last_name }}</a> 
              </li>
            {% endif %}
        {% endfor %}
      </ul>
      <a href="/add_member/{{ trip_code }}">Add members to this trip</a>

      <h5>Trip Stats </h5>
      <h6>Trip Date: {{ trip_date }}</h6>
      <h6>Trip Duration: {{ trip_length }} day </h6>
      <h6>Trip Location: {{ trip_loc }}</h6>
      <h6>Markers: </h6>
  </div>

  <div class="col-xs-5" >
    <div ng-controller="ListController" style="width: 400px, height: 300px display: inline-block">
      <h3>To-Do List</h3>
      <form ng-submit="addAll(itemDetail, addItem)" style="height: 300px; overflow-y: scroll" name="myform">

        <table class="table table-striped table-bordered">
          <thead >
            <tr>
              <th>Action Items</th>
              <th>Action Assigned</th>
              <th>Done(Y/N)</th>
            </tr>
          </thead>
          <tbody style="height: 200px; overflow-y: scroll">
            <tr ng-repeat="itemDetail in itemDetails" ng-model="itemDetail.item_id">
              <td>
                <input type="text" class="form-control" ng-model="itemDetail.description"/>
              </td>
              <td>
                <input type="text" class="form-control" ng-model="itemDetail.userid" typeahead="user.userID for user in usernames | filter: $viewValue"/>
              </td>
              <td>
                <input type="checkbox" ng-model="itemDetail.selected"/>
              </td>
            </tr>
            <tr >
              <td>
                <input type="text" class="form-control" ng-model="addItem.description" ng-init="addItem.description=none"/>
              </td>
              <td>
                <input type="text" class="form-control" ng-model="addItem.userid" ng-init="addItem.userid=none" uib-typeahead="user.userID for user in usernames | filter: $viewValue"/>
              </td>
              <td>
                <input type="checkbox" ng-model="addItem.selected" ng-init="addItem.selected=false"/>
              </td>
            </tr>
          </tbody>
        </table>

        <div class="form-group">
          <!-- <input ng-hide="!itemDetails.length" type="button" class="btn btn-danger pull-right" ng-click="remove()" value="Remove"> -->
          <input type="submit" class="btn btn-primary addnew pull-right" value="Update" ng-click="addAll">
        </div>
      </form>   
    </div>
  </div>
</div>

<div class="row" style="height: 400px">
  <div class="col-xs-8">
    <div id="floating-panel">
      <input id="address" type="textbox" value="Yosemite Valley, CA">
      <input id="submit" type="button" value="Geocode">
      <input id="submarker" type="button" value="Log This Route">
    </div>
    <div class="row">
      <div class="col-xs-10" id="map" style="width: 70%; height: 400px; "></div>
      <div class="col-xs-3" style="overflow-y: scroll; height: 400px">
        <ul id="trailDesc"></ul>
      </div>
      <div id="elevation_chart"></div>
    </div>
  </div>

  <div class="col-xs-4">
    <div id="chatlogs" style="width: 600px" >
        <h3>Group Communication:</h3>
      
       <ul id="messages" style="height: 100px; overflow-y:scroll">
        {% for msg in messages %}
          <li style="width: 100">{{ msg.comment }}</li>

        {% endfor %}
       </ul>
    </div>
    <div id="chat-end"></div>

  <div >
    <form id="sendmessage">
      <textarea rows="4" cols="40" id="mytext" name="mymessage"></textarea>
      <input id="sendbutton" type="button" value="Send Message">
    </form>
  </div>
</div>
</div>

<!-- Place your scripts here:  -->
<!-- <script src="https://code.jquery.com/jquery.js"></script> -->
<script type="text/javascript"> 
var tripCode = "{{ trip_code }}";

// google.load('visualization', '1', {packages: ['columnchart']});


</script>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<script type="text/javascript" src="/static/myscript.js"></script>
<script type="text/javascript" src="/static/chat.js"></script>
<!-- <script src="/static/trip_detail.js"></script> -->
<script src="/static/my_ang.js"></script>
<script src="/static/create_trip.js"></script>

<script src="https://maps.googleapis.com/maps/api/js?key=key&callback=initMap"
async defer></script>




{% endblock %}